DELIMITER //
CREATE FUNCTION calculate_discount
(cust_id CHAR(8)) RETURNS DECIMAL(10,2)
COMMENT 'Calculate Customer discount'
BEGIN
 DECLARE total DECIMAL(10,2);
 DECLARE discount DECIMAL(10,2);
 SELECT SUM(amount) INTO total FROM payments WHERE customerNumber = cust_id;
 SET discount = total * .05;
 RETURN discount;
END;
//
DELIMITER ;

CREATE VIEW product_info_view as
SELECT p.id, m.nane as manufacturer_name, p.name, p.price FROM manufacturer m, product p 
WHERE m.id=p.m anufacturer_id AND p.price>5000